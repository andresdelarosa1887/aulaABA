---
title: "02_PerformanceAnalytics"
output: html_document
date: "2023-06-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Performace Analytics

El paquete `PerformaceAnalytics` es una colección de funciones econométricas para el análisis de rendimiento y riesgo.

Además de las métricas estándar de riesgo y rendimiento, este paquete tiene como objetivo ayudar a los profesionales e investigadores a utilizar las últimas investigaciones en el análisis de flujos de retornos no normales.

En general, se ha probado más en datos de retornos (en lugar de precios) en una escala regular, pero la mayoría de las funciones también funcionarán con datos de retornos irregulares, y cada vez más funciones funcionarán con datos de ganancias y pérdidas o precios cuando sea posible.

Podemos auxiliarnos de quantmod para importar los datos diarios de las acciones y realizar analisis sobre los mismos utilizando Performance Analytics.

```{r}
library(PerformanceAnalytics)
library(quantmod)
library(lubridate)


FAANG <- c("AAPL", "GOOGL", "AMZN", "META", "NFLX")
getSymbols(FAANG, from= "2015-01-01", to= today())

##Usando solo quantmod
retornos_diarios <- merge(dailyReturn(Cl(AAPL)),dailyReturn(Cl(GOOGL)),
                          dailyReturn(Cl(AMZN)), dailyReturn(Cl(META)),
                          dailyReturn(Cl(NFLX)))
colnames(retornos_diarios) <- c("AAPL", "GOOGL", "AMZN", "META", "NFLX")


##Usando Performance Analytics
retornos_diarios <-  Return.calculate(FAANG_data)

head(retornos_diarios)
```


El Value at Risk (VaR), que se traduce al español como Valor en Riesgo o Valor de Riesgo, es una medida ampliamente utilizada en finanzas para evaluar y cuantificar el riesgo de pérdida potencial en una inversión o cartera de inversión. Es una medida estadística que proporciona una estimación del máximo monto de pérdida esperada (en términos de valor monetario o porcentaje) en un nivel de confianza específico y para un horizonte de tiempo determinado.


Si tienes un Value at Risk (VaR) del -0.03 con un intervalo de confianza del 95% para los retornos diarios, significa que existe una probabilidad del 95% de que las pérdidas diarias no excedan el valor de -0.03.



El método "Gaussian VaR" (VaR Gaussiano) en el gráfico chart.VaRSensitivity de la librería "PerformanceAnalytics" en R se refiere a una aproximación del Value at Risk (VaR) basada en la suposición de que los retornos siguen una distribución normal o gaussiana.

```{r}

chart.Histogram(retornos_diarios$AAPL, methods = c("add.density","add.centered"))

chart.VaRSensitivity(retornos_diarios$GOOGL, 
                     methods=c("HistoricalVaR","GaussianVaR"), 
                     colorset=bluefocus, lwd=2)

```


El índice de desempeño, el ratio de información y el ratio de Sharpe son métricas utilizadas en el análisis de inversiones y finanzas para evaluar y comparar el rendimiento y riesgo de una inversión. A continuación, te explico brevemente cada uno y su diferencia:

Índice de desempeño (Performance Index): El índice de desempeño es una métrica que evalúa la capacidad de una estrategia de inversión para generar retornos ajustados al riesgo a lo largo del tiempo. Se calcula tomando en cuenta tanto el rendimiento absoluto como el riesgo asumido. Un índice de desempeño más alto indica una estrategia más exitosa en términos de obtener rendimientos superiores ajustados al riesgo.

Ratio de información (Information Ratio): El ratio de información compara el rendimiento de una estrategia de inversión con respecto a un benchmark o referencia. Mide la capacidad de la estrategia para generar retornos en exceso en relación con la volatilidad o riesgo asumido en comparación con el benchmark. Un ratio de información más alto indica que la estrategia ha generado mayores retornos ajustados al riesgo en comparación con el benchmark.

Ratio de Sharpe (Sharpe Ratio): El ratio de Sharpe es una medida de la rentabilidad ajustada al riesgo de una inversión. Calcula la relación entre el rendimiento promedio en exceso de una inversión (es decir, el rendimiento por encima de una tasa libre de riesgo) y la volatilidad o riesgo asumido. Un ratio de Sharpe más alto indica una mayor rentabilidad ajustada al riesgo.

La diferencia entre estas métricas radica en los aspectos que consideran al evaluar el rendimiento y el riesgo de una inversión. Mientras que el índice de desempeño se enfoca en el rendimiento absoluto y el riesgo general de la estrategia, el ratio de información se centra en la capacidad de superar un benchmark específico. Por otro lado, el ratio de Sharpe evalúa la rentabilidad ajustada al riesgo en relación con una tasa libre de riesgo. Cada métrica proporciona una perspectiva diferente para evaluar la calidad y el éxito de una estrategia de inversión.

El índice de Sortino es otra métrica utilizada en el análisis de inversiones y finanzas para evaluar y comparar el rendimiento ajustado al riesgo de una inversión, centrándose específicamente en el riesgo a la baja o el riesgo de pérdidas.

En el paquete "performanceanalytics" de R, la función SortinoRatio() se utiliza para calcular el índice de Sortino. Esta función toma como argumentos los retornos de una estrategia de inversión y un umbral o tasa mínima deseada de rendimiento. La fórmula del índice de Sortino es la siguiente:

Índice de Sortino = (Rendimiento promedio - Tasa mínima de rendimiento) / Volatilidad de los retornos negativos

La función SortinoRatio() calcula este índice teniendo en cuenta solo los retornos negativos, ya que se enfoca en medir y evaluar el riesgo de pérdidas.

```{r}
library(performanceanalytics)

table.Stats(retornos_diarios)
table.Drawdowns(retornos_diarios$AAPL, top=10, geometric= TRUE)
table.AnnualizedReturns(retornos_diarios)


```