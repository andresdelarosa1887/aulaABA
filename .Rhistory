for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
warning(paste("Error leyendo archivo:", archivo))
})
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
warning(paste("Error leyendo archivo:", archivo))
})
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}
# tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
#   warning(paste("Error leyendo archivo:", archivo))
# })
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
# tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
#   warning(paste("Error leyendo archivo:", archivo))
# })
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
# tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
#   warning(paste("Error leyendo archivo:", archivo))
# })
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
# tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
#   warning(paste("Error leyendo archivo:", archivo))
# })
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
# tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
#   warning(paste("Error leyendo archivo:", archivo))
# })
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
library(tidyverse)
limpieza_operaciones_diarias <- function(archivo_operaciones_diarias, fecha_operacion){
operaciones_diarias <- readRDS(paste0("data/", archivo_operaciones_diarias))
colnames(operaciones_diarias) <- operaciones_diarias[6,]
colnames(operaciones_diarias)[8] <- "NA2"
operaciones_diarias <- operaciones_diarias[7:(nrow(operaciones_diarias)),]
operaciones_diarias <- operaciones_diarias %>% select(-c("NA", "NA2"))
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$fecha_operacion <- fecha_operacion
return(operaciones_diarias)
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
# tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
#   warning(paste("Error leyendo archivo:", archivo))
# })
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
View(listado_operaciones_diarias)
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
# operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
warning(paste("Error leyendo archivo:", archivo))
})
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
warnings()
rownames(listado_operaciones_diarias) <- NULL
View(listado_operaciones_diarias)
##Importacion desde la WEB de un Excel
library(httr)
library(readxl)
library(tidyverse)
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")) {
print(archivo)}
limpieza_operaciones_diarias <- function(archivo_operaciones_diarias, fecha_operacion){
operaciones_diarias <- readRDS(paste0("data/", archivo_operaciones_diarias))
colnames(operaciones_diarias) <- operaciones_diarias[6,]
colnames(operaciones_diarias)[8] <- "NA2"
operaciones_diarias <- operaciones_diarias[7:(nrow(operaciones_diarias)),]
operaciones_diarias <- operaciones_diarias %>% select(-c("NA", "NA2"))
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$fecha_operacion <- fecha_operacion
return(operaciones_diarias)
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
# operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
warning(paste("Error leyendo archivo:", archivo))
})
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
View(listado_operaciones_diarias)
colnames(listado_operaciones_diarias)
limpieza_operaciones_diarias <- function(archivo_operaciones_diarias, fecha_operacion){
operaciones_diarias <- readRDS(paste0("data/", archivo_operaciones_diarias))
colnames(operaciones_diarias) <- operaciones_diarias[6,]
colnames(operaciones_diarias)[8] <- "NA2"
operaciones_diarias <- operaciones_diarias[7:(nrow(operaciones_diarias)),]
operaciones_diarias <- operaciones_diarias %>% select(-c("NA", "NA2"))
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias$`Fecha Op.` <- as.numeric(operaciones_diarias$`Fecha Op.`)
operaciones_diarias$`Fecha Op.` <- as.Date(operaciones_diarias$`Fecha Op.`, origin= "1899-12-30")
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$fecha_operacion <- fecha_operacion
return(operaciones_diarias)
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
# operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
warning(paste("Error leyendo archivo:", archivo))
})
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
colnames(listado_operaciones_diarias)
rownames(listado_operaciones_diarias) <- NULL
View(listado_operaciones_diarias)
write_rds(listado_operaciones_diarias, "Modulo #2 Importacion Avanzada y Casos Practicos/Semana 4- Casos Practicos/data/operaciones_diarias_rv.rds")
Sys.Date()
secuencia_fechas <- seq(inicio_fecha, final_fecha, by= 1)
inicio_fecha = as.Date("2023-01-01")
final_fecha= Sys.Date()
secuencia_fechas <- seq(inicio_fecha, final_fecha, by= 1)
secuencia_fechas
secuencia_fechas <- secuencia_fechas[!weekdays(secuencia_fechas) %in% c("Saturday", "Sunday") ]
weekdays(secuencia_fechas)
feriadosRD2023 <- c("2023-01-01", #Ano nuevo
"2023-01-02", #Dia de Fiesta random
"2023-01-09", #Dia de los reyes
"2023-01-21", #Dia de la altagracia
"2023-01-30", #Dia de duarte
"2023-02-27", #Dia de la independencia
"2023-04-07", # Viernes Santo
"2023-05-01", #Dia del trabajo
"2023-06-08", #Corpus Christi
"2023-08-16", #Dia de la Restauracion
"2023-09-24", # Dia de las mercedes
"2023-11-06", #Dia de la constitucion
"2023-12-25") ##Navidad
secuencia_fechas <- secuencia_fechas[!secuencia_fechas %in% as.Date(feriadosRD2023)]
data_fechas <- as.data.frame(secuencia_fechas)
View(data_fechas)
data_fechas$dia <- day(data_fechas$secuencia_fechas)
library(lubridate)
data_fechas$dia <- day(data_fechas$secuencia_fechas)
View(data_fechas)
data_fechas$mes <- month(data_fechas$secuencia_fechas)
View(data_fechas)
data_fechas$dia <- ifelse(nchar(day(data_fechas$secuencia_fechas)) != 2,
paste0("0", as.character(day(data_fechas$secuencia_fechas))),
day(data_fechas$secuencia_fechas))
View(data_fechas)
data_fechas$mes <- ifelse(nchar(month(data_fechas$secuencia_fechas)) != 2,
paste0("0", as.character(month(data_fechas$secuencia_fechas))),
month(data_fechas$secuencia_fechas))
View(data_fechas)
for (mes in levels(as.factor(data_fechas$mes))) {
print(mes)
}
for (mes in levels(as.factor(data_fechas$mes))) {
for dias in levels(as.factor(data_fechas$dia))
print(mes, dia)
}
for (mes in levels(as.factor(data_fechas$mes))) {
for dias in levels(as.factor(data_fechas$dia)){
print(mes, dia)
}
}
for (mes in levels(as.factor(data_fechas$mes))) {
for (dias in levels(as.factor(data_fechas$dia))){
print(mes, dia)}
}
for (mes in levels(as.factor(data_fechas$mes))) {
for (dias in levels(as.factor(data_fechas$dia))){
print(mes, dias)}
}
for (mes in levels(as.factor(data_fechas$mes))) {
print(mes)
for (dias in levels(as.factor(data_fechas$dia))){
print(dias)}
}
for (mes in levels(as.factor(data_fechas$mes))) {
print(paste("mes",mes))
for (dias in levels(as.factor(data_fechas$dia))){
print(dias)}
}
for (mes in levels(as.factor(data_fecha$mes))){
print(mes)
}
data_fechas <- as.data.frame(secuencia_fechas)
data_fechas$dia <- ifelse(nchar(day(data_fechas$secuencia_fechas)) != 2,
paste0("0", as.character(day(data_fechas$secuencia_fechas))),
day(data_fechas$secuencia_fechas))
data_fechas$mes <- ifelse(nchar(month(data_fechas$secuencia_fechas)) != 2,
paste0("0", as.character(month(data_fechas$secuencia_fechas))),
month(data_fechas$secuencia_fechas))
for (mes in levels(as.factor(data_fecha$mes))){
print(mes)
}
for (mes in levels(as.factor(data_fechas$mes))){
print(mes)
}
for (mes in levels(as.factor(data_fechas$mes))){
print(mes)
for( dia in levels(as.factor(data_fechas$dia))) {
print(dia)
}
}
for (mes in levels(as.factor(data_fechas$mes))){
print(paste("mes:", mes))
for( dia in levels(as.factor(data_fechas$dia))) {
print(dia)
}
}
for (mes in levels(as.factor(data_fechas$mes))){
print(paste("mes:", mes))
dias <- data_fechas[data_fechas$mes==mes,]$dia
for(dia in dias) {
print(dia)
}
}
for (mes in levels(as.factor(data_fechas$mes))){
print(paste("mes:", mes))
dias <- data_fechas[data_fechas$mes==mes,]$dia
for(dia in dias) {
consolidadoBVRDLink <- paste0("https://bvrd.com.do/boletines/boletin-bvrd-consolidado-excel-",dia,"-",mes,"-","23/")
GET(consolidadoBVRDLink, write_disk(tf <- tempfile(fileext = ".xlsx")), add_headers(`Connection` = "keep-alive", `User-Agent` = UA))
operaciones_diarias_rv <- read_excel(tf, sheet =  "BB_RVMSOperDia")
write_rds(operaciones_diarias_rv, paste0("renta_variable/", dia,"-",mes,"-","23-","operaciones_diarias_rv.rds"))
}}
for (mes in levels(as.factor(data_fechas$mes))){
print(paste("mes:", mes))
dias <- data_fechas[data_fechas$mes==mes,]$dia
for(dia in dias) {
consolidadoBVRDLink <- paste0("https://bvrd.com.do/boletines/boletin-bvrd-consolidado-excel-",dia,"-",mes,"-","23/")
GET(consolidadoBVRDLink, write_disk(tf <- tempfile(fileext = ".xlsx")))
operaciones_diarias_rv <- read_excel(tf, sheet =  "BB_RVMSOperDia")
write_rds(operaciones_diarias_rv, paste0("renta_variable/", dia,"-",mes,"-","23-","operaciones_diarias_rv.rds"))
}}
GET("https://bvrd.com.do/boletines/boletin-bvrd-consolidado-pdf-24-05-23/", write_disk(tf <- tempfile(fileext = ".xlsx")), add_headers(`Connection` = "keep-alive", `User-Agent` = UA))
operaciones_diarias_rv <- read_excel(tf, sheet =  "BB_RVMSOperDia")
GET("https://bvrd.com.do/boletines/boletin-bvrd-consolidado-pdf-24-05-23/", write_disk(tf <- tempfile(fileext = ".xlsx")))
##Proceso de Importacion de datos BVRD desde r
UA <- "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"
##Proceso de Importacion de datos BVRD desde r
UA <- "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"
for (mes in levels(as.factor(data_fechas$mes))){
print(paste("mes:", mes))
dias <- data_fechas[data_fechas$mes==mes,]$dia
for(dia in dias) {
consolidadoBVRDLink <- paste0("https://bvrd.com.do/boletines/boletin-bvrd-consolidado-excel-",dia,"-",mes,"-","23/")
GET(consolidadoBVRDLink, write_disk(tf <- tempfile(fileext = ".xlsx")), add_headers(`Connection` = "keep-alive", `User-Agent` = UA))
operaciones_diarias_rv <- read_excel(tf, sheet =  "BB_RVMSOperDia")
write_rds(operaciones_diarias_rv, paste0("renta_variable/", dia,"-",mes,"-","23-","operaciones_diarias_rv.rds"))
}}
`24-05-23-operaciones_diarias_rv` <- readRDS("~/GitHub/aulaABA/finanzas_con_r/aulaABA/renta_variable/24-05-23-operaciones_diarias_rv.rds")
View(`24-05-23-operaciones_diarias_rv`)
list.files("data/", pattern =  "operaciones_diarias_rf")
operaciones_diarias <- readRDS("data/02-02-23-operaciones_diarias_rf.rds")
View(operaciones_diarias)
operaciones_diarias <- readRDS("data/18-01-23-operaciones_diarias_rf.rds")
View(operaciones_diarias)
colnames(operaciones_diarias) <- operaciones_diarias[4,]
View(operaciones_diarias)
operaciones_diarias <- operaciones_diarias[5:(nrow(operaciones_diarias)-2), ]
View(operaciones_diarias)
operaciones_diarias <- operaciones_diarias %>% select(-"NA")
View(operaciones_diarias)
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
View(operaciones_diarias)
list.files("data/", pattern =  "operaciones_diarias_rf")
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern =  "operaciones_diarias_rf")) {
print(archivo)
}
limpieza_operaciones_diarias <- function(archivo_operaciones_diarias, fecha_operacion) {
operaciones_diarias <- readRDS(paste0( "data/",archivo_operaciones_diarias ))
colnames(operaciones_diarias) <- operaciones_diarias[4,]
operaciones_diarias <- operaciones_diarias[5:(nrow(operaciones_diarias)-2), ]
operaciones_diarias <- operaciones_diarias %>% select(-"NA")
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias$fecha_operacion <- fecha_operacion
return(operaciones_diarias)
}
##Importacion desde la WEB de un Excel
library(readxl)
library(tidyverse)
limpieza_operaciones_diarias <- function(archivo_operaciones_diarias, fecha_operacion) {
operaciones_diarias <- readRDS(paste0( "data/",archivo_operaciones_diarias ))
colnames(operaciones_diarias) <- operaciones_diarias[4,]
operaciones_diarias <- operaciones_diarias[5:(nrow(operaciones_diarias)-2), ]
operaciones_diarias <- operaciones_diarias %>% select(-"NA")
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias$fecha_operacion <- fecha_operacion
return(operaciones_diarias)
}
for (archivo in list.files("data/", pattern =  "operaciones_diarias_rf")) {
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
}
View(operaciones_transformadas)
for (archivo in list.files("data/", pattern =  "operaciones_diarias_rf")) {
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern =  "operaciones_diarias_rf")) {
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
View(listado_operaciones_diarias)
listado_operaciones_diarias =do.call(rbind, listado_operaciones_diarias)
rownames(listado_operaciones_diarias)
rownames(listado_operaciones_diarias) <- NA
rownames(listado_operaciones_diarias) <- NULL
View(listado_operaciones_diarias)
listado_operaciones_diarias <- na.omit(listado_operaciones_diarias)
View(listado_operaciones_diarias)
list.files("data/", pattern =  "operaciones_diarias_rv")
list.files("data/", pattern =  "operaciones_diarias_rv")
##Importacion desde la WEB de un Excel
library(readxl)
library(tidyverse)
list.files("data/", pattern =  "operaciones_diarias_rv")
operaciones_diarias <- readRDS(paste0("data/", "09-03-23-operaciones_diarias_rv.rds"))
View(operaciones_diarias)
colnames(operaciones_diarias) <- operaciones_diarias[6, ]
View(operaciones_diarias)
colnames(operaciones_diarias)[8] <- "NA2"
View(operaciones_diarias)
operaciones_diarias <- operaciones_diarias[7:nrow(operaciones_diarias),]
View(operaciones_diarias)
operaciones_diarias <- operaciones_diarias %>% select(-c("NA", "NA2"))
View(operaciones_diarias)
operaciones_diarias <- na.omit(operaciones_diarias)
View(operaciones_diarias)
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias$`Fecha Op.` <- as.numeric(operaciones_diarias$`Fecha Op.`)
operaciones_diarias$`Fecha Op.` <- as.Date(operaciones_diarias$`Fecha Op.`, origin= "1899-12-30")
View(operaciones_diarias)
operaciones_diarias <- na.omit(operaciones_diarias)
View(operaciones_diarias)
limpieza_operaciones_diarias <- function(archivo_operaciones_diarias, fecha_operacion){
operaciones_diarias <- readRDS(paste0("data/", archivo_operaciones_diarias))
colnames(operaciones_diarias) <- operaciones_diarias[6,]
colnames(operaciones_diarias)[8] <- "NA2"
operaciones_diarias <- operaciones_diarias[7:(nrow(operaciones_diarias)),]
operaciones_diarias <- operaciones_diarias %>% select(-c("NA", "NA2"))
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$`Fecha Venc.` <- as.numeric(operaciones_diarias$`Fecha Venc.`)
operaciones_diarias$`Fecha Venc.` <- as.Date(operaciones_diarias$`Fecha Venc.`, origin= "1899-12-30")
operaciones_diarias$`Fecha Liq` <- as.numeric(operaciones_diarias$`Fecha Liq`)
operaciones_diarias$`Fecha Liq` <- as.Date(operaciones_diarias$`Fecha Liq`, origin= "1899-12-30")
operaciones_diarias$`Fecha Op.` <- as.numeric(operaciones_diarias$`Fecha Op.`)
operaciones_diarias$`Fecha Op.` <- as.Date(operaciones_diarias$`Fecha Op.`, origin= "1899-12-30")
operaciones_diarias <- na.omit(operaciones_diarias)
operaciones_diarias$fecha_operacion <- fecha_operacion
return(operaciones_diarias)
}
listado_operaciones_diarias = list()
for (archivo in list.files("data/", pattern = "operaciones_diarias_rv")){
print(paste("Procesando:", archivo))
##Sacando el mes y el dia de la operacion del nombre del archivo
dia_operacion= substr(archivo, 1,2)
mes_operacion= substr(archivo, 4,5)
ano_operacion= 2023
fecha_operacion= as.Date(paste0(ano_operacion, "-", mes_operacion,"-",dia_operacion))
# operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)
tryCatch({operaciones_transformadas= limpieza_operaciones_diarias(archivo, fecha_operacion)}, error = function(e) {
warning(paste("Error leyendo archivo:", archivo))
})
listado_operaciones_diarias[[archivo]] <- operaciones_transformadas
}
warning()
View(listado_operaciones_diarias)
listado_operaciones_diarias = do.call(rbind, listado_operaciones_diarias)
rownames(listado_operaciones_diarias) <- NULL
View(listado_operaciones_diarias)
